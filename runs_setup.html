<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Runs Setup &mdash; RT Retrieval Framework  documentation</title>
    
    <link rel="stylesheet" href="_static/better.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     '',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="top" title="RT Retrieval Framework  documentation" href="index.html" />
    <link rel="next" title="Lua Configuration" href="lua.html" />
    <link rel="prev" title="Testing" href="testing.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
      <link rel="stylesheet" href="_static/custom.css" type="text/css" />
  </head>
  <body role="document">
    <header id="pageheader"><h1><a href="index.html ">
        RT Retrieval Framework  documentation
    </a></h1></header>
  <div class="related top">
  <nav id="rellinks">
    <ul>
        <li>
          &larr;
          <a href="testing.html" title="Previous document">Testing</a>
        </li>
        <li>
          <a href="lua.html" title="Next document">Lua Configuration</a>
          &rarr;
        </li>
    </ul>
  </nav>
  <nav id="breadcrumbs">
    <ul>
      <li><a href="index.html">Home</a></li> 
    </ul>
  </nav>
  </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="runs-setup">
<h1>Runs Setup<a class="headerlink" href="#runs-setup" title="Permalink to this headline">¶</a></h1>
<div class="section" id="populator-usage">
<h2>Populator Usage<a class="headerlink" href="#populator-usage" title="Permalink to this headline">¶</a></h2>
<p>After following the details on the <a class="reference internal" href="setup.html"><em>Setup</em></a> page you should be ready to run the L2 FP support software needed to set up retrieval inputs.</p>
<p>Inside the <code class="docutils literal"><span class="pre">level_2/support</span></code> directory there is a tool known as &#8220;The Populator&#8221;, which can generate the directory configuration needed by the L2 FP retrieval code. The setup scripts mentioned in previous sections will export this path to your environment so that you can run this program from anywhere on the system.</p>
</div>
<div class="section" id="populator-data-sources">
<h2>Populator Data Sources<a class="headerlink" href="#populator-data-sources" title="Permalink to this headline">¶</a></h2>
<p>This tool can produce run directories for any of the following data sources:</p>
<ul class="simple">
<li>gosat - GOSAT flight data</li>
<li>fts - TCCON FTS data</li>
<li>oco - OCO downlooking data</li>
<li>oco_uplooking - OCO uplooking data</li>
</ul>
<p>At the minimum, for &#8220;gosat&#8221; or &#8220;oco&#8221; data sources the following files are needed:</p>
<ul class="simple">
<li>L1B HDF file (.hdf)</li>
<li>Resampled ECMWF HDF file (.hdf)</li>
</ul>
<p>The &#8220;fts&#8221; data source requires the following files:</p>
<ul class="simple">
<li>Run log file (.grl)</li>
<li>A and B spectra files (.XXX where XXX is a 3 digit number)</li>
<li>ASCII atmosphere file, which has been converted from GFIT&#8217;s .mav file (.dat)</li>
</ul>
</div>
<div class="section" id="populator-config-file-creation">
<h2>Populator Config File Creation<a class="headerlink" href="#populator-config-file-creation" title="Permalink to this headline">¶</a></h2>
<p>To use the Populator to set up a run directory, you will need to create a <code class="docutils literal"><span class="pre">.config</span></code> file that allows the Populator to find the various files it needs as well as to identify the data source.</p>
<p>At a minimum the config creation tool needs the data source type name and the path to the files mentioned in the last section for each data source type. In the following examples a bogus path is used for illustration purposes only. The path can be relative or absolute.</p>
<p>The Populator assumes that it will places all of its files inside of the directory where a configuration file is located. Therefore, it is best for each configuration to have its own directory.</p>
<p>Once you have created your directory chdir to it. Any of the follow examples are performed from the directory that serves as the base of your runs. The config file will live in the base directory.</p>
<p>For example, to create a config file for a &#8220;oco&#8221; data source you would run the following command from directory you created:</p>
<div class="highlight-console"><div class="highlight"><pre><span></span><span class="gp">$</span> create_config.py -t oco /path/to/oco_L1b_data.h5 /path/to/oco_Ecm_data.h5
</pre></div>
</div>
<p>Once the command has finished executing you will have a new .config file with a name based upon the data source type and the current directory.</p>
<p>Optionally, you can specify a different config file name for output using the <code class="docutils literal"><span class="pre">-o</span></code> option. Additionally one can filter the sounding ids used based upon a user supplied list of sounding ids by providing the <code class="docutils literal"><span class="pre">-l</span></code> option.</p>
<p>For GOSAT data, the two polarization channels &#8220;S&#8221; and &#8220;P&#8221; are indicated by the appending of these letters to a sounding id. A pure numeral sounding id without either of these characters indicates that the S and P channels should be averaged.</p>
<p>To create a FTS config file you would use the &#8220;fts&#8221; data source and point to all the required files. For example:</p>
<div class="highlight-console"><div class="highlight"><pre><span></span><span class="gp">$</span> create_config.py -t fts /path/to/runlog.grl /path/to/spectra-a.001 /path/to/spectra-b.001 ... /path/to/atmosphere_from_gfit.dat
</pre></div>
</div>
<p>Note in the above the ellipsis indicate that you would specify ALL the spectra files as inputs on the command line. Using shell globbing is acceptable as all the filenames in a directory will be expanded before the shell passes control to the program. Additionally, <code class="docutils literal"><span class="pre">create_config.py</span></code> will ignore any files it does not know anything about.</p>
<p>Help text describing available options are displayed by running the program with the following option:</p>
<div class="highlight-console"><div class="highlight"><pre><span></span><span class="gp">$</span> create_config.py --help
</pre></div>
</div>
</div>
<div class="section" id="run-directory-population">
<h2>Run Directory Population<a class="headerlink" href="#run-directory-population" title="Permalink to this headline">¶</a></h2>
<p>Once you have a config file you are ready to use the Populator program.</p>
<p>At a minimum this program needs the name of a config file and optionally the path to a L2 FP binary. If a path to a L2 FP binary is not specified then helper scripts for running the created inputs will not be created.</p>
<p>For example to populate the run directories for a config file created for an &#8220;oco&#8221; data source you would run the following command:</p>
<div class="highlight-console"><div class="highlight"><pre><span></span><span class="gp">$</span> populate.py -b /path/to/my/l2_fp oco_my_runs.config
</pre></div>
</div>
<p>Once the program has stopped executing you will have the following directories and files:</p>
<table border="1" class="docutils">
<colgroup>
<col width="17%" />
<col width="83%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>sdos_input_list.dat</td>
<td>Contains versioning information as well as details on source files and directories used by the Populator</td>
</tr>
<tr class="row-even"><td>sounding_id.list</td>
<td>List of sounding ids to be processed.</td>
</tr>
<tr class="row-odd"><td>l2_fp_job.sh, launch_jobs.sh</td>
<td>When the &#8220;-b&#8221; option is given to populate.py this file these files are created to aid in running the software as explained in a later section.</td>
</tr>
</tbody>
</table>
<p>When <code class="docutils literal"><span class="pre">l2_fp_job.sh</span></code> is run for the first time, the following directories will be created:</p>
<table border="1" class="docutils">
<colgroup>
<col width="33%" />
<col width="67%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>log</td>
<td>Directory where log files for per sounding runs are written</td>
</tr>
<tr class="row-even"><td>output</td>
<td>Directory where HDF5 output files are written</td>
</tr>
</tbody>
</table>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h3><a href="index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Runs Setup</a><ul>
<li><a class="reference internal" href="#populator-usage">Populator Usage</a></li>
<li><a class="reference internal" href="#populator-data-sources">Populator Data Sources</a></li>
<li><a class="reference internal" href="#populator-config-file-creation">Populator Config File Creation</a></li>
<li><a class="reference internal" href="#run-directory-population">Run Directory Population</a></li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="testing.html"
                        title="previous chapter">Testing</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="lua.html"
                        title="next chapter">Lua Configuration</a></p>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="_sources/runs_setup.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<form class="search" action="search.html" method="get">
  <input type="text" name="q"
   placeholder="type to search" />
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
  <div class="related bottom">
  <nav id="rellinks">
    <ul>
        <li>
          &larr;
          <a href="testing.html" title="Previous document">Testing</a>
        </li>
        <li>
          <a href="lua.html" title="Next document">Lua Configuration</a>
          &rarr;
        </li>
    </ul>
  </nav>
  <nav id="breadcrumbs">
    <ul>
      <li><a href="index.html">Home</a></li> 
    </ul>
  </nav>
  </div>
  <footer id="pagefooter">&copy; Copyright 2016 California Institute of Technology. U.S. Government sponsorship acknowledged.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a>
      1.3.6
        with the <a href="http://github.com/irskep/sphinx-better-theme">
          better</a> theme.

  </footer>

  
  </body>
</html>